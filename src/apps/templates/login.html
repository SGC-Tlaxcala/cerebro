{% extends "cerebro/base.html" %}
{% load static %}
{% load i18n %}

{% block title %}Iniciar sesión{% endblock %}

{% block content %}
<section class="relative min-h-[90vh] overflow-hidden">
  <div class="absolute inset-0 rounded-3xl overflow-hidden">
    <div class="absolute inset-0 bg-[url('{% static 'img/fondo_login.jpg' %}')] bg-cover bg-center opacity-60"></div>
    <div class="absolute inset-0 bg-gradient-to-br from-gray-950/70 via-gray-900/65 to-gray-900/40 mix-blend-multiply"></div>
    <div class="absolute -left-20 -top-24 h-80 w-80 rounded-full bg-primary/25 blur-3xl"></div>
    <div class="absolute -right-16 bottom-0 h-72 w-72 rounded-full bg-secondary/20 blur-3xl"></div>
  </div>

  <div class="relative mx-auto flex max-w-6xl flex-col items-center px-4 py-16 md:flex-row md:justify-between md:py-24 gap-10">
    <div class="max-w-xl space-y-4 text-white drop-shadow">
      <span class="inline-flex items-center gap-2 rounded-full bg-white/10 px-4 py-2 text-sm font-semibold text-primary-50 ring-1 ring-white/20 backdrop-blur">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="h-5 w-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 7.5h18M3 12h18M3 16.5h10.5" />
        </svg>
        SGC Tlaxcala
      </span>
      <h1 class="text-4xl font-extrabold leading-tight md:text-5xl">Bienvenido de vuelta</h1>
      <p class="text-lg text-white/80 md:text-xl">Accede al Sistema de Gestión de la Calidad con tus credenciales institucionales.</p>
      <div class="flex items-center gap-3 text-sm text-white/70">
        <span class="inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 ring-1 ring-white/15">Seguro y controlado</span>
        <span class="inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 ring-1 ring-white/15">Documentación centralizada</span>
      </div>
    </div>

    <div class="w-full max-w-md rounded-3xl border border-white/15 bg-white/90 p-8 shadow-2xl backdrop-blur">
      <div class="mb-6 flex items-center justify-between">
        <img src="{% static 'img/logoINE-01.png' %}" alt="Logo INE" class="h-10">
        <span class="text-sm font-semibold text-primary">SGC Tlaxcala</span>
      </div>

      {% if user.is_authenticated %}
        <h2 class="text-2xl font-bold text-gray-900">Ya estás dentro</h2>
        <p class="mt-2 text-sm text-gray-600">Sesión activa como <strong>{{ request.user.get_full_name|default:request.user.username }}</strong>.</p>
        <a href="{% url 'index' %}" class="btn btn-primary mt-6 w-full">Ir al inicio</a>
      {% else %}
        <div class="mb-4 rounded-2xl border border-primary/20 bg-primary/5 px-4 py-3 text-sm text-primary">
          Acceso restringido. Si necesitas una cuenta, solicita acceso al responsable del SGC.
        </div>

        <form method="post" action="{% url 'login' %}" class="space-y-4">
          {% csrf_token %}
          <div class="form-control">
            <label for="id_username" class="label">
              <span class="label-text font-semibold text-gray-700">Usuario</span>
            </label>
            <input type="text" name="username" id="id_username" class="input input-bordered w-full" placeholder="tu.usuario" required autofocus>
          </div>
          <div class="form-control">
            <label for="id_password" class="label">
              <span class="label-text font-semibold text-gray-700">Contraseña</span>
            </label>
            <input type="password" name="password" id="id_password" class="input input-bordered w-full" placeholder="••••••••" required>
          </div>
          <input type="hidden" name="next" value="{{ next }}">
          <button class="btn btn-primary w-full" type="submit">Ingresar</button>
        </form>
      {% endif %}
    </div>
  </div>
</section>
{% endblock content %}
