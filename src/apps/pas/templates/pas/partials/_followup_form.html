<form hx-post="{{ form_action }}"
      hx-target="#pas-modal-content"
      hx-swap="innerHTML"
      class="space-y-6"
      enctype="multipart/form-data">
  {% csrf_token %}
  <header class="space-y-1">
    <h3 class="text-xl font-semibold text-base-content">Registrar seguimiento</h3>
    <p class="text-sm text-base-content/70">
      Actualiza el estado de la actividad:
      <span class="font-semibold text-base-content">{{ activity.accion|striptags|truncatechars:80 }}</span>
    </p>
  </header>

  {{ form.media }}

  {% if form.non_field_errors %}
    <div class="alert alert-error">
      {% for error in form.non_field_errors %}
        <span>{{ error }}</span>
      {% endfor %}
    </div>
  {% endif %}

  <div class="grid gap-6">
    <div class="form-control">
      {{ form.descripcion.label_tag }}
      {{ form.descripcion }}
      {% for error in form.descripcion.errors %}<p class="mt-1 text-xs text-error">{{ error }}</p>{% endfor %}
    </div>
    <div class="grid gap-6 md:grid-cols-2">
      <div class="form-control">
        {{ form.fecha.label_tag }}
        {{ form.fecha }}
        {% for error in form.fecha.errors %}<p class="mt-1 text-xs text-error">{{ error }}</p>{% endfor %}
      </div>
      <div class="form-control">
        {{ form.estado.label_tag }}
        {{ form.estado }}
        {% for error in form.estado.errors %}<p class="mt-1 text-xs text-error">{{ error }}</p>{% endfor %}
      </div>
    </div>
    <div class="grid gap-6 md:grid-cols-2">
      <div class="form-control">
        <label class="label">
          <span class="label-text font-semibold">{{ form.responsable.label }}</span>
        </label>
        <div class="flex items-center gap-2">
          {{ form.responsable }}
          <button type="button"
                  class="btn btn-ghost btn-square"
                  title="Agregar usuario"
                  data-profiles-modal-trigger
                  hx-get="{% url 'profiles:user-quick-add' %}"
                  hx-target="#profiles-user-modal-content"
                  hx-swap="innerHTML">
            <span class="sr-only">Agregar usuario</span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="size-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.5 20.118a7.5 7.5 0 0 1 15 0A17.933 17.933 0 0 1 12 21.75c-2.68 0-5.22-.584-7.5-1.632Z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M18 8.25V12m1.875-1.875H22.5" />
            </svg>
          </button>
        </div>
        {% if form.responsable.help_text %}<p class="mt-1 text-xs text-base-content/60">{{ form.responsable.help_text }}</p>{% endif %}
        {% for error in form.responsable.errors %}<p class="mt-1 text-xs text-error">{{ error }}</p>{% endfor %}
      </div>
      <div class="form-control">
        {{ form.evidencia.label_tag }}
        {{ form.evidencia }}
        {% for error in form.evidencia.errors %}<p class="mt-1 text-xs text-error">{{ error }}</p>{% endfor %}
      </div>
    </div>
  </div>

  <div class="flex flex-wrap items-center gap-3">
    <button type="submit" class="btn btn-primary">Guardar seguimiento</button>
    <button type="button" class="btn btn-ghost" data-close-modal="{{ modal_id|default:'pas-modal' }}">Cancelar</button>
  </div>
</form>
